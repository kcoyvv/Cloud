# yaml锚点(不懂自行Google)勿动
proxy-provider-http: &http
  type: http
  interval: 3600
  health-check:
    enable: false
    url: https://1.1.1.1/generate_204
    interval: 7200

proxy-provider-file: &file
  type: file
  health-check:
    enable: false
    url: https://1.1.1.1/generate_204
    interval: 7200

#Meta核心配置，如果不知道Meta核是什么请用下面的Premium核心配置
mixed-port: 7890
allow-lan: false
mode: rule
log-level: info
ipv6: false

external-controller: 127.0.0.1:9090
# 控制面板相对路径
# external-ui: folder

dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:1053
  default-nameserver:
   - 223.5.5.5
   - 119.29.29.29
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.lan'
    - "+.stun.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*.*"
    - localhost.ptlogin2.qq.com
    - "+.pool.ntp.org"
    - miwifi.com

  nameserver:
    - 'https://doh.pub/dns-query'
    - 'https://223.5.5.5/dns-query'
  nameserver-policy:
    "geosite:!cn":
      - 'tls://8.8.4.4:853#Proxy'

  proxy-server-nameserver:
    - 119.29.29.29
    - 223.5.5.5

# 如果有节点可按文档填写，并在group内使用
proxies:
   #- name: JPARM 转发
     #type: ss
     #server: 36.140.181.4
     #port: 43307
     #cipher: aes-256-gcm
     #password: 8nfdttdfuAiSZzE4Fo13gwA7Ah7AFNJ2W3jBaQhElqrH
     #udp: true


proxy-groups:
  - name: PROXY
    type: select
    # proxies引用别的组或者配置在文件内proxies的节点
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国
      # 如有配置proxies部分可按如下格式使用配置文件内自定义的节点(非订阅节点)

  - name: Apple
    type: select
    proxies:
      - DIRECT
      - PROXY

  - name: Steam
    type: select
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国

  - name: Netflix
    type: select
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国

  - name: Tiktok
    type: select
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国

  - name: Spotify
    type: select
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国

  - name: FINAL
    type: select
    proxies:
      - DIRECT
      - PROXY

  - name: 香港
    type: select
    use:
      - Sub1
      # 当proxy-provider配置多个订阅时，使用use下方格式引用，这里为只有一个订阅的情况
      # - Sub2
      # - Sub3
    # filter使用正则表达式去筛选节点
    filter: "HK|Hong|香港|港|急速"

  - name: 狮城
    type: select
    use:
      - Sub1
      # - Sub2
      # - Sub3
    filter: "SG|Singapore|狮城|新加坡"

  - name: 日本
    type: select
    use:
      - Sub1
      # - Sub2
      # - Sub3
    filter: "JP|japan|日本"

  - name: 美国
    type: select
    use:
      - Sub1
      # - Sub2
      # - Sub3
    filter: "US|United|美|美国"
  
  - name: 台湾
    type: select
    use:
      - Sub1
      # - Sub2
      # - Sub3
    filter: "台湾|TW|TaiWan|台"

  - name: 韩国
    type: select
    use:
      - Sub1
      # - Sub2
      # - Sub3
    filter: "韩国|KR|Korea|韩"

  - name: 其他
    type: select
    use:
      - Sub1
      # - Sub2
      # - Sub3
    # 筛选除日美新港外的节点，可自行按格式添加
    filter: "^(?!.*(?:Hong|HK|TW|KR|Taiwan|USA|Japan|Singapore|USA|韩国|香港|日本|新加坡|美国)).*"


# proxy-provider 可参考meta内核文档 https://clash-meta.wiki/config/proxy-providers
proxy-providers:
  # 在线订阅,有多个机场按格式书写在下面
  Sub1:
    <<: *http
    path: ./proxies/Sub1.yaml
    url: https://sub01.fkknet.cn/api/v1/client/subscribe?token=d2c349df7a4e82da3b2870669e8ec11e

  #Sub2:
    #<<: *http
    #path: ./proxies/Sub2.yaml
    #url: https://dyue-01.windmi.xyz/api/v1/client/subscribe?token=d9a9fe451422ca3937657c641ffc560c
  #
  # 本地节点，路径可填写绝对路径或者相对路径(为clash工作目录下)
  #Sub3:
    #<<: *file
    #path: D:\OneDrive\Clash配置文件\Sub3.yaml

# 可参考meta核文档 https://clash-meta.wiki/config/rules/rule-provider
rule-providers:
  WeChat:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/WeChat/WeChat.yaml"
    path: ./ruleset/WeChat.yaml
    interval: 86400

  icloud:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/iCloud/iCloud.yaml"
    path: ./ruleset/icloud.yaml
    interval: 86400

  apple:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical.yaml"
    path: ./ruleset/apple.yaml
    interval: 86400

  Steam:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Steam/Steam.yaml"
    path: ./ruleset/Steam.yaml
    interval: 86400

  Netflix:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix_Classical.yaml"
    path: ./ruleset/Netflix.yaml
    interval: 86400

  Tiktok:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok.yaml"
    path: ./ruleset/Tiktok.yaml
    interval: 86400

  Spotify:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.yaml"
    path: ./ruleset/Spotify.yaml
    interval: 86400

  PROXY:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global_Classical.yaml"
    path: ./ruleset/PROXY.yaml
    interval: 86400

  direct:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/direct.txt"
    path: ./ruleset/direct.yaml
    interval: 86400

  private:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  gfw:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/gfw.txt"
    path: ./ruleset/gfw.yaml
    interval: 86400

  greatfire:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/greatfire.txt"
    path: ./ruleset/greatfire.yaml
    interval: 86400

  tld-not-cn:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/tld-not-cn.txt"
    path: ./ruleset/tld-not-cn.yaml
    interval: 86400

  cncidr:
    type: http
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  lancidr:
    type: http
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/Loyalsoldier/clash-rules/release/lancidr.txt"
    path: ./ruleset/lancidr.yaml
    interval: 86400

# 规则部分建议域名规则在前，ip规则在后
# ip规则尽量使用no-resolve，减少需要走代理的域名在本地解析的情况
rules:
  - RULE-SET,PROXY,PROXY
  - RULE-SET,private,DIRECT
  - RULE-SET,icloud,Apple
  - RULE-SET,apple,Apple
  - RULE-SET,Netflix,Netflix
  - RULE-SET,Tiktok,Tiktok
  - RULE-SET,Spotify,Spotify
  - RULE-SET,WeChat,DIRECT
  - RULE-SET,Steam,Steam
  - RULE-SET,direct,DIRECT
  - RULE-SET,lancidr,DIRECT
  - RULE-SET,cncidr,DIRECT
  - GEOIP,LAN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,FINAL