mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
external-controller: '127.0.0.1:9090'

dns:
    enable: true
    ipv6: false
    default-nameserver: [223.5.5.5, 119.29.29.29, 114.114.114.114]
    enhanced-mode: fake-ip
    fake-ip-range: 198.18.0.1/16
    use-hosts: true
    follow-rules: true
    proxy-server-nameserver: [223.5.5.5, 119.29.29.29, 114.114.114.114]
    nameserver: [223.5.5.5, 119.29.29.29, 114.114.114.114]
    fallback: [1.1.1.1, 8.8.8.8]
    fallback-filter: { geoip: true, geoip-code: CN, geosite: [gfw], ipcidr: [240.0.0.0/4], domain: [+.google.com, +.facebook.com, +.youtube.com] }

# 如果有节点可按文档填写，并在group内使用
proxies:
   #- name: JPARM 转发
     #type: ss
     #server: 36.140.181.4
     #port: 43307
     #cipher: aes-256-gcm
     #password: 8nfdttdfuAiSZzE4Fo13gwA7Ah7AFNJ2W3jBaQhElqrH
     #udp: true


proxy-groups:
  - name: 代理
    type: select
    # proxies引用别的组或者配置在文件内proxies的节点
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国
      # 如有配置proxies部分可按如下格式使用配置文件内自定义的节点(非订阅节点)

  - name: 苹果
    type: select
    proxies:
      - 直连
      - 代理

  - name: 奈飞
    type: select
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国

  - name: 抖音
    type: select
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国

  - name: 音乐
    type: select
    proxies:
      - 狮城
      - 日本
      - 台湾
      - 香港
      - 美国
      - 韩国

  - name: 直连
    type: url-test
    hidden: true
    proxies:
      - DIRECT

  - name: 兜底
    type: select
    proxies:
      - 代理
      - 直连

  - name: 香港
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    include-all: true
    hidden: true
    use:
      - 流量光
      # 当proxy-provider配置多个订阅时，使用use下方格式引用，这里为只有一个订阅的情况
      # - Sub2
      # - Sub3
    # filter使用正则表达式去筛选节点
    filter: "HK|Hong|🇭🇰|香港|港|急速"

  - name: 狮城
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    include-all: true
    hidden: true
    use:
      - 流量光
      # - Sub2
      # - Sub3
    filter: "SG|Singapore|🇸🇬|狮城|新加坡"

  - name: 日本
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    include-all: true
    hidden: true
    use:
      - 流量光
      # - Sub2
      # - Sub3
    filter: "JP|japan|🇯🇵|日本"

  - name: 美国
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    include-all: true
    hidden: true
    use:
      - 流量光
      # - Sub2
      # - Sub3
    filter: "US|United|🇺🇸|美|美国"
  
  - name: 台湾
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    include-all: true
    hidden: true
    use:
      - 流量光
      # - Sub2
      # - Sub3
    filter: "台湾|TW|TaiWan|台"

  - name: 韩国
    interval: 120
    lazy: true
    tolerance: 50
    type: url-test
    include-all: true
    hidden: true
    use:
      - 流量光
      # - Sub2
      # - Sub3
    filter: "韩国|🇰🇷|KR|Korea|韩"

  - name: 其他
    type: select
    use:
      - 流量光
      # - Sub2
      # - Sub3
    # 筛选除日美新港外的节点，可自行按格式添加
    filter: "^(?!.*(?:Hong|HK|TW|KR|Taiwan|🇨🇳|客户|http|USA|Japan|Singapore|USA|韩国|香港|日本|新加坡|美国)).*"


  # 在线订阅,有多个机场按格式书写在下面
use: &use
  type: select
  use:
    - 流量光
#    - 本地配置

# 订阅链接
# 对于订阅来说，path 为选填项，但建议启用
# 本地配置可以只填 path
proxy-providers:
  流量光:
    <<: *p
    path: ./proxy_provider/流量光.yaml
    url: "https://rgergergergerg6555.saojc.xyz/api/v1/client/subscribe?token=7ec3e41ef6c2ec767145fc02bbbf06e1"


# 可参考meta核文档 https://clash-meta.wiki/config/rules/rule-provider
rule-providers:
  Apple:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical.yaml"
    path: ./ruleset/Apple.yaml
    interval: 86400

  Netflix:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix_Classical.yaml"
    path: ./ruleset/Netflix.yaml
    interval: 86400

  Tiktok:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok.yaml"
    path: ./ruleset/Tiktok.yaml
    interval: 86400

  Spotify:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.yaml"
    path: ./ruleset/Spotify.yaml
    interval: 86400

  Global:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global_Classical.yaml"
    path: ./ruleset/Global.yaml
    interval: 86400

# 规则部分建议域名规则在前，ip规则在后
# ip规则尽量使用no-resolve，减少需要走代理的域名在本地解析的情况
rules:
  - RULE-SET,Apple,苹果
  - RULE-SET,Netflix,奈飞
  - RULE-SET,Tiktok,抖音
  - RULE-SET,Spotify,音乐
  - RULE-SET,Global,代理
  - GEOIP,LAN,直连
  - GEOIP,CN,直连
  - MATCH,兜底